(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9883],{37578:(e,s,l)=>{Promise.resolve().then(l.bind(l,98643))},98643:(e,s,l)=>{"use strict";l.r(s),l.d(s,{default:()=>S});var t=l(42289),n=l(22500),r=l(12040),a=l(98526),i=l(43918),c=l(85675),d=l(91858),o=l(82640),x=l(83241),u=l(41058),h=l(55033),m=l(86339),j=l(30862),f=l(6492),g=l(84088),v=l(34946),p=l(87918),N=l(74929),y=l(70381),b=l(75249),w=l.n(b),_=l(42405),k=l(86645);function S(){var e;let s=(0,y.useTranslations)("order"),{getUserInfo:l}=(0,c.A)(),[b,S]=(0,k.useState)(),[C,P]=(0,k.useState)(!1),{data:q}=(0,x.I)({enabled:C,queryKey:["queryPurchaseOrder",b],queryFn:async()=>{var e,s,t;if(!b)return;let n=localStorage.getItem(b),r=n?JSON.parse(n):{},{data:a}=await (0,d.kp)({order_no:b,...r});return(null==a||null==(e=a.data)?void 0:e.status)!==1&&(P(!1),(null==a||null==(s=a.data)?void 0:s.token)&&((0,o.sV)(null==a||null==(t=a.data)?void 0:t.token),await new Promise(e=>setTimeout(e,100)),await l())),null==a?void 0:a.data},refetchInterval:3e3}),{data:F}=(0,x.I)({enabled:!!b&&(null==q?void 0:q.status)===1,queryKey:["purchaseCheckout",b],queryFn:async()=>{var e,s;let{data:l}=await (0,d.k8)({orderNo:b,returnUrl:window.location.href});return(null==(e=l.data)?void 0:e.type)==="url"&&(null==(s=l.data)?void 0:s.checkout_url)&&window.open(l.data.checkout_url,"_blank"),null==l?void 0:l.data}});(0,k.useEffect)(()=>{let e=new URLSearchParams(location.search);e.get("order_no")&&(S(e.get("order_no")),P(!0))},[]);let[$,I]=(0,v.A)({targetDate:q&&(0,p.GP)((0,N.z)(null==q?void 0:q.created_at,15),"yyyy-MM-dd'T'HH:mm:ss.SSSxxx")}),{hours:T,minutes:E,seconds:L}=I,A=$>0?(0,t.jsxs)(t.Fragment,{children:[1===T.toString().length?"0".concat(T):T," :"," ",1===E.toString().length?"0".concat(E):E," :"," ",1===L.toString().length?"0".concat(L):L]}):(0,t.jsx)(t.Fragment,{children:s("timeExpired")});return(0,t.jsx)("main",{className:"container lg:mt-16",children:(0,t.jsxs)("div",{className:"grid gap-4 xl:grid-cols-2",children:[(0,t.jsxs)(m.Zp,{className:"order-2 xl:order-1",children:[(0,t.jsx)(m.aR,{className:"bg-muted/50 flex flex-row items-start",children:(0,t.jsxs)("div",{className:"grid gap-0.5",children:[(0,t.jsxs)(m.ZB,{className:"flex flex-col text-lg",children:[s("orderNumber"),(0,t.jsx)("span",{children:null==q?void 0:q.order_no})]}),(0,t.jsxs)(m.BT,{children:[s("createdAt"),": ",(0,g.Yq)(null==q?void 0:q.created_at)]})]})}),(0,t.jsxs)(m.Wu,{className:"grid gap-3 p-6 text-sm",children:[(0,t.jsx)("div",{className:"font-semibold",children:s("paymentMethod")}),(0,t.jsx)("dl",{className:"grid gap-3",children:(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsx)("dt",{className:"text-muted-foreground",children:(0,t.jsx)(u.E,{children:(null==q?void 0:q.payment.name)||(null==q?void 0:q.payment.platform)})})})}),(0,t.jsx)(j.w,{}),(null==q?void 0:q.status)&&[1,2].includes(q.status)&&(0,t.jsx)(i._,{subscribe:{...null==q?void 0:q.subscribe,quantity:null==q?void 0:q.quantity}}),(null==q?void 0:q.status)===3&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"font-semibold",children:s("resetTraffic")}),(0,t.jsx)("ul",{className:"grid grid-cols-2 gap-3 *:flex *:items-center *:justify-between lg:grid-cols-1",children:(0,t.jsxs)("li",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground line-clamp-2 flex-1",children:s("resetPrice")}),(0,t.jsx)("span",{children:(0,t.jsx)(n.n,{type:"currency",value:q.amount})})]})})]}),(null==q?void 0:q.status)===4&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"font-semibold",children:s("balanceRecharge")}),(0,t.jsx)("ul",{className:"grid grid-cols-2 gap-3 *:flex *:items-center *:justify-between lg:grid-cols-1",children:(0,t.jsxs)("li",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground line-clamp-2 flex-1",children:s("rechargeAmount")}),(0,t.jsx)("span",{children:(0,t.jsx)(n.n,{type:"currency",value:q.amount})})]})})]}),(0,t.jsx)(j.w,{}),(0,t.jsx)(a.M,{order:{...q,unit_price:null==q||null==(e=q.subscribe)?void 0:e.unit_price}})]})]}),(0,t.jsx)(m.Zp,{className:"order-1 flex flex-auto items-center justify-center xl:order-2",children:(0,t.jsxs)(m.Wu,{className:"py-16",children:[(null==q?void 0:q.status)&&[2,5].includes(null==q?void 0:q.status)&&(0,t.jsxs)("div",{className:"flex flex-col items-center gap-8 text-center",children:[(0,t.jsx)("h3",{className:"text-2xl font-bold tracking-tight",children:s("paymentSuccess")}),(0,t.jsx)(f.Icon,{icon:"mdi:success-circle-outline",className:"text-7xl text-green-500"}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)(h.$,{asChild:!0,children:(0,t.jsx)(w(),{href:"/dashboard",children:s("subscribeNow")})}),(0,t.jsx)(h.$,{variant:"outline",children:(0,t.jsx)(w(),{href:"/document",children:s("viewDocument")})})]})]}),(null==q?void 0:q.status)===1&&(null==F?void 0:F.type)==="url"&&(0,t.jsxs)("div",{className:"flex flex-col items-center gap-8 text-center",children:[(0,t.jsx)("h3",{className:"text-2xl font-bold tracking-tight",children:s("waitingForPayment")}),(0,t.jsx)("p",{className:"flex items-center text-3xl font-bold",children:A}),(0,t.jsx)(f.Icon,{icon:"mdi:access-time",className:"text-muted-foreground text-7xl"}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)(h.$,{onClick:()=>{(null==F?void 0:F.checkout_url)&&(window.location.href=null==F?void 0:F.checkout_url)},children:s("goToPayment")}),(0,t.jsx)(h.$,{variant:"outline",children:(0,t.jsx)(w(),{href:"/",children:s("productList")})})]})]}),(null==q?void 0:q.status)===1&&(null==F?void 0:F.type)==="qr"&&(0,t.jsxs)("div",{className:"flex flex-col items-center gap-8 text-center",children:[(0,t.jsx)("h3",{className:"text-2xl font-bold tracking-tight",children:s("scanToPay")}),(0,t.jsx)("p",{className:"flex items-center text-3xl font-bold",children:A}),(0,t.jsx)(_.X,{value:(null==F?void 0:F.checkout_url)||"",size:208,imageSettings:{src:"/payment/alipay_f2f.svg",width:24,height:24,excavate:!0}}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)(h.$,{asChild:!0,children:(0,t.jsx)(w(),{href:"/subscribe",children:s("productList")})}),(0,t.jsx)(h.$,{asChild:!0,variant:"outline",children:(0,t.jsx)(w(),{href:"/order",children:s("orderList")})})]})]}),(null==q?void 0:q.status)===1&&(null==F?void 0:F.type)==="stripe"&&(0,t.jsxs)("div",{className:"flex flex-col items-center gap-8 text-center",children:[(0,t.jsx)("h3",{className:"text-2xl font-bold tracking-tight",children:s("waitingForPayment")}),(0,t.jsx)("p",{className:"flex items-center text-3xl font-bold",children:A}),F.stripe&&(0,t.jsx)(r.A,{...F.stripe})]}),(null==q?void 0:q.status)&&[3,4].includes(null==q?void 0:q.status)&&(0,t.jsxs)("div",{className:"flex flex-col items-center gap-8 text-center",children:[(0,t.jsx)("h3",{className:"text-2xl font-bold tracking-tight",children:s("orderClosed")}),(0,t.jsx)(f.Icon,{icon:"mdi:cancel",className:"text-7xl text-red-500"}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)(h.$,{asChild:!0,children:(0,t.jsx)(w(),{href:"/subscribe",children:s("productList")})}),(0,t.jsx)(h.$,{asChild:!0,variant:"outline",children:(0,t.jsx)(w(),{href:"/order",children:s("orderList")})})]})]})]})})]})})}}},e=>{e.O(0,[7162,6318,3607,9077,6976,3241,6794,2973,3538,3769,1098,8207,4445,3367,7358],()=>e(e.s=37578)),_N_E=e.O()}]);